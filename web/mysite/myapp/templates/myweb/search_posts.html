{% extends 'myweb/base.html' %}

{% block title %}ค้นหาประกาศ{% endblock %}

{% load form_tags %}

{% block background_style %}
background-color: rgba(255, 255, 255);
{% endblock %}

{% block content %}
<div class="row">
    {% for giver_post in giver_posts %}
        <div class="col-md-4 mb-4">
            <div class="card h-100">
                <div class="text-center mt-3 mb-3">
                    <img src="{{ giver_post.stuff_picture.url }}" 
                    alt="Stuff Picture" class="card-img-top" style="width: 200px;">
                </div>
                <div class="card-body">
                    <h5 class="card-title"><strong>{{ giver_post.stuff_name }}</strong></h5>
                    <p class="card-text">ประเภท: {{ giver_post.categories }}</p>
                    <p class="card-text">วันที่โพสต์: {{ giver_post.created_at|date_thai }}</p>
                    <p class="card-text">อัพเดตล่าสุด: {{ giver_post.updated_at|date_thai }}</p>
                    <div class="d-flex justify-content-center">
                        <a class="btn btn-danger mx-1 btn-lg" href="{% url 'results_posts' %}" title="จับคู่โพสต์นี้">จับคู่</a>
                        <button type="button" class="btn btn-dark mx-1" data-bs-toggle="modal" data-bs-target="#detailsModal{{ giver_post.post_ID }}">ดูรายละเอียด</button>
                    </div>
                    <!-- Print post ID for debugging -->
                    <p>Post ID: {{ giver_post.post_ID }}</p>  <!-- Debugging line -->
                </div>
            </div>
        </div>

        <!-- Modal for Details -->
        <div class="modal fade" id="detailsModal{{ giver_post.post_ID }}" tabindex="-1" aria-labelledby="detailsModalLabel{{ giver_post.post_ID }}" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title" id="detailsModalLabel{{ giver_post.id }}">{{ giver_post.stuff_name }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="text-center">
                            <img src="{{ giver_post.stuff_picture.url }}" alt="Stuff Picture" class="img-fluid" style="width: 100%;">
                        </div>
                        <h6>รายละเอียด:</h6>
                        <p>{{ giver_post.description }}</p>
                        <h6>ประเภท:</h6>
                        <p>{{ giver_post.categories }}</p>
                        <h6>สถานที่:</h6>
                        <p>{{ giver_post.place }}</p>
                        <h6>ตำหนิ:</h6>
                        <p>{{ giver_post.defect }}</p>
                        <h6>วันที่โพสต์:</h6>
                        <p>{{ giver_post.created_at|date_thai }}</p>
                        <h6>อัพเดตล่าสุด:</h6>
                        <p>{{ giver_post.updated_at|date_thai }}</p>
                        <!-- Print post ID in the modal for debugging -->
                        <p>Modal ID: {{ giver_post.post_ID }}</p>  <!-- Debugging line -->
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ปิด</button>
                    </div>
                </div>
            </div>
        </div>

    {% empty %}
        <p>ไม่พบประกาศที่ตรงกับผู้บริจาค</p>
    {% endfor %}
</div>

{% endblock %}
