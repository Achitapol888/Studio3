{% extends 'myweb/base.html' %}

{% load static %}

{% load form_tags %}

{% block title %}
ผู้รับ
{% endblock %}

{% block background_style %}
background-color: rgba(0, 0, 0);
{% endblock %}

{% block styles %}
<!-- Add more CSS files here -->
<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
{% endblock %}

{% block content %} 
    <div class="container mt-5 col-lg-6">
        <div class="card">
            <div class="card-header">
                <h5 class="card-title text-center">เเบบฟอร์มของผู้ต้องการรับสิ่งของ</h5>
            </div>
            <div class="card-body">
                {% if form.errors %}
                    <div class="alert alert-danger">
                        <strong>กรุณาใส่เเบบฟอร์มให้ถูกต้อง:</strong>
                        <ul>
                            {% for field in form %}
                                {% for error in field.errors %}
                                    <li>{{ error }}</li>
                                {% endfor %}
                            {% endfor %}
                            {% for error in form.non_field_errors %}
                                <li>{{ error }}</li>
                            {% endfor %}
                        </ul>
                    </div>
                {% endif %}
                
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    
                    <div class="mb-3">
                        <label for="{{ form.stuff_name.id_for_label }}" class="form-label">ชื่อสิ่งของ</label>
                        {{ form.stuff_name|add_class:"form-control" }}
                        {% for error in form.stuff_name.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.categories.id_for_label }}" class="form-label">ประเภท</label>
                        {{ form.categories|add_class:"form-control" }}
                        {% for error in form.categories.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.description.id_for_label }}" class="form-label">รายละเอียด</label>
                        {{ form.description|add_class:"form-control" }}
                        {% for error in form.description.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.defect.id_for_label }}" class="form-label">ตำหนิ</label>
                        {{ form.defect|add_class:"form-control" }}
                        {% for error in form.defect.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.place.id_for_label }}" class="form-label">สถานที่</label>
                        {{ form.place|add_class:"form-control" }}
                        {% for error in form.place.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>

                    <div class="mb-3">
                        <label for="{{ form.date_limit.id_for_label }}" class="form-label">ต้องการรับภายในวันที่</label>
                        {{ form.date_limit|add_class:"form-control" }}
                        {% for error in form.date_limit.errors %}
                            <div class="text-danger">{{ error }}</div>
                        {% endfor %}
                    </div>
                    <div class="text-end">
                        <button type="submit" class="btn btn-primary">โพสต์</button>
                    </div>
                    
                </form>
            </div>
        </div>
    </div>

{% endblock %}

{% block script %}
<script>

    const dateInput = document.getElementById('date');
    const formattedDateDisplay = document.getElementById('formattedDate');

    dateInput.addEventListener('change', function() {
        const selectedDate = new Date(dateInput.value);
        const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long', hour: '2-digit', minute: '2-digit', timeZone: 'Asia/Bangkok', hour12: false };
        const thaiFormattedDate = new Intl.DateTimeFormat('th-TH', options).format(selectedDate);
        formattedDateDisplay.textContent = `วันที่เลือก: ${thaiFormattedDate}`;
    });
    
</script>
{% endblock %}
